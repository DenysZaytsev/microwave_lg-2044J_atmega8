[platformio]
; –°–µ—Ä–µ–¥–æ–≤–∏—â–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è 16–ú–ì—Ü —á–µ—Ä–µ–∑ Bootloader
default_envs = upload_16mhz

;===============================================================
; A. –ó–ê–ì–ê–õ–¨–ù–Ü –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø (—Ç—ñ–ª—å–∫–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä)
;===============================================================
[common_settings]
platform = atmelavr
framework = arduino
board = ATmega8
board_build.lto = yes
board_bod.type = 2.7v
board_eeprom.type = retain
; –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ avrdude.conf –≤—ñ–¥ MiniCore (–∑ –≤–∞—à–æ—ó –∫–æ–º–∞–Ω–¥–∏)
board_avrdude.conf_path = ${platformio.packages_dir}/framework-arduino-avr-minicore/avrdude.conf

;===============================================================
; B. –°–ï–†–ï–î–û–í–ò–©–ê –î–õ–Ø –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ö–û–î–£ (Upload via Bootloader)
; (–¶–µ –≤–∞—à —Ä–æ–±–æ—á–∏–π –º–µ—Ç–æ–¥, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–∞—à—É –∫–æ–º–∞–Ω–¥—É)
;===============================================================
[common_bootloader_upload]
extends = common_settings
; –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑ –≤–∞—à–æ—ó –∫–æ–º–∞–Ω–¥–∏
upload_protocol = arduino
upload_port = /dev/cu.usbserial-1440
upload_speed = 19200
; –í–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
upload_command = avrdude -v -C ${common_settings.board_avrdude.conf_path} -p $BOARD_MCU -c $UPLOAD_PROTOCOL -P $UPLOAD_PORT -b $UPLOAD_SPEED -B 10 -U flash:w:$SOURCE
; --- –í–∞—à "—Ö–∞–∫" –¥–ª—è LTO —Ç–∞ —Ä–æ–∑–º—ñ—Ä—É ---
board_bootloader.type = uart0
board_upload.maximum_size = 8192
board_upload.bootloader_size = 0

[env:upload_16mhz]
extends = common_bootloader_upload
board_build.f_cpu = 16000000L

[env:upload_8mhz]
extends = common_bootloader_upload
board_build.f_cpu = 8000000L

;===============================================================
; C. –°–ï–†–ï–î–û–í–ò–©–ê –î–õ–Ø –ü–†–û–®–ò–í–ö–ò FUSES (—Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ ArduinoISP)
; (–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ '... --target fuses' –¢–Ü–õ–¨–ö–ò –∑ Nano)
;===============================================================
[common_isp_fuses]
extends = common_settings
; --- üî¥ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: –ö–∞–∂–µ–º–æ MiniCore –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ bootloader ---
; –¶–µ–π –±–ª–æ–∫ –ù–ï –º—ñ—Å—Ç–∏—Ç—å "—Ö–∞–∫—É" 'board_bootloader.type = uart0'
board_bootloader.type = no_bootloader
; --- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è "Arduino as ISP" ---
upload_protocol = stk500v1
upload_port = /dev/cu.usbserial-1440
upload_speed = 19200
upload_flags = -B 10
; hfuse 0xDE = –ó–ë–ï–†–Ü–ì–¢–ò Bootloader (512b), SPIEN, Brown-out 2.7V
; (–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ 0xDE, —â–æ–± –ù–ï —Å—Ç–µ—Ä—Ç–∏ –≤–∞—à bootloader)
board_fuses.hfuse = 0xDE

[env:fuses_16mhz]
extends = common_isp_fuses
board_build.f_cpu = 16000000L
board_fuses.lfuse = 0xFF ; External Crystal >8MHz

[env:fuses_8mhz]
extends = common_isp_fuses
board_build.f_cpu = 8000000L
board_fuses.lfuse = 0xE4 ; Internal 8MHz


; --- üî¥ –ö–û–ú–ê–ù–î–ê AVRDUDE –î–õ–Ø FUSES (16MHz) ---
; /Users/user/.platformio/packages/tool-avrdude/avrdude -C "/Users/user/.platformio/packages/framework-arduino-avr-minicore/avrdude.conf" -p atmega8 -c stk500v1 -P /dev/cu.usbserial-1440 -b 19200 -B 10 -U lfuse:w:0xFF:m -U hfuse:w:0xDE:m

; --- üî¥ –ö–û–ú–ê–ù–î–ê AVRDUDE –î–õ–Ø FUSES (8MHz) ---
; /Users/user/.platformio/packages/tool-avrdude/avrdude -C "/Users/user/.platformio/packages/framework-arduino-avr-minicore/avrdude.conf" -p atmega8 -c stk500v1 -P /dev/cu.usbserial-1440 -b 19200 -B 10 -U lfuse:w:0xE4:m -U hfuse:w:0xDE:m