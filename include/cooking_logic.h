#ifndef COOKING_LOGIC_H_
#define COOKING_LOGIC_H_

#include "microwave_firmware.h"

// ============================================================================
// --- üü® –ü–†–û–¢–û–¢–ò–ü–ò –§–£–ù–ö–¶–Ü–ô ---
// ============================================================================

/**
 * @brief –ù–∞–ª–∞—à—Ç–æ–≤—É—î –ø—ñ–Ω–∏ (DDR, PORT) –¥–ª—è –≤—Å—å–æ–≥–æ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è.
 */
void setup_hardware(void);

/**
 * @brief –ö–µ—Ä—É—î –º–∞–≥–Ω–µ—Ç—Ä–æ–Ω–æ–º, –≤—Ä–∞—Ö–æ–≤—É—é—á–∏ MIN_SAFE_OFF_TIME —Ç–∞ ZVS_MODE.
 */
void set_magnetron(bool on);

/**
 * @brief –ö–µ—Ä—É—î –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–º.
 */
void set_fan(bool on);

/**
 * @brief –†–æ–∑—Ä–∞—Ö–æ–≤—É—î —á–∞—Å —É–≤—ñ–º–∫–Ω–µ–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –®–Ü–ú (g_pwm_on_time_seconds)
 * –Ω–∞ –æ—Å–Ω–æ–≤—ñ g_cook_power_level —Ç–∞ g_pwm_cycle_duration.
 * –í—Ä–∞—Ö–æ–≤—É—î MIN_SAFE_ON_TIME —Ç–∞ MIN_SAFE_OFF_TIME.
 */
void calculate_pwm_on_time(void);

/**
 * @brief –†–æ–∑—Ä–∞—Ö–æ–≤—É—î —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ü–∏–∫–ª—É –®–Ü–ú (g_pwm_cycle_duration)
 * –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É –≥–æ—Ç—É–≤–∞–Ω–Ω—è (–∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –®–Ü–ú).
 */
void recalculate_adaptive_pwm(void);

/**
 * @brief –ó–∞–ø—É—Å–∫–∞—î —Ü–∏–∫–ª –≥–æ—Ç—É–≤–∞–Ω–Ω—è (STATE_COOKING).
 * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –¥–≤–µ—Ä—ñ, –≤–º–∏–∫–∞—î –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä, –º–∞–≥–Ω–µ—Ç—Ä–æ–Ω, —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –®–Ü–ú.
 * @return true, —è–∫—â–æ —Å—Ç–∞—Ä—Ç —É—Å–ø—ñ—à–Ω–∏–π, false, —è–∫—â–æ –¥–≤–µ—Ä—ñ –≤—ñ–¥–∫—Ä–∏—Ç—ñ.
 */
bool start_cooking_cycle(void);

/**
 * @brief –í—ñ–¥–Ω–æ–≤–ª—é—î –≥–æ—Ç—É–≤–∞–Ω–Ω—è –∑—ñ —Å—Ç–∞–Ω—É PAUSED.
 * –í–º–∏–∫–∞—î –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è —Ç–∞ —Å–∫–∏–¥–∞—î —Ç–∞–π–º–µ—Ä g_timer_ms.
 */
void resume_cooking(void);

/**
 * @brief –ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è-–ª—ñ—á–∏–ª—å–Ω–∏–∫. –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —â–æ—Å–µ–∫—É–Ω–¥–∏.
 * –í—ñ–¥–ª—ñ—á—É—î g_cook_time_total_sec, –∫–µ—Ä—É—î –®–Ü–ú,
 * –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞ –ø–µ—Ä–µ–≤–µ—Ä—Ç–∞–Ω–Ω—è —Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥–æ—Ç—É–≤–∞–Ω–Ω—è.
 */
void update_cook_timer(void);

// üîΩüîΩüîΩ –í–ò–î–ê–õ–ï–ù–û –ü–†–û–¢–û–¢–ò–ü–ò enter_sleep_mode —Ç–∞ wake_up_from_sleep (ZVS MODE 2) üîΩüîΩüîΩ
/*
#if (ZVS_MODE == 2)
void enter_sleep_mode();
void wake_up_from_sleep();
#endif
*/

#endif // COOKING_LOGIC_H_